---
Title: Delphiでリフレクションするぞ
Category:
- Delphi
Date: 2014-02-01T10:16:04+09:00
URL: https://yoshiyoshifujii.hatenablog.com/entry/2014/02/01/101604
EditURL: https://blog.hatena.ne.jp/yoshiyoshifujii/yoshiyoshifujii.hatenablog.com/atom/entry/12921228815717633390
---

Javaでリフレクションしたことあるし、Delphiでもしてーなーって。
っていうか、この仕様を実装するならリフレクションっしょ。
ってな感じで調べたー。

Delphiでリフレクションするには、まず、TRttiContextクラスをインスタンス化する。
ほいで、TRttiContextのメソッドにクラスタイプを指定して、クラスを特定する。

>|pascal|
uses
  SysUtils, Rtti;
 
var
  LContext: TRttiContext;
  LType: TRttiType;
 
begin
  LContext := TRttiContext.Create();
  try
    LType := LContext.GetType('クラス名');
  finally
    LContext.Free;
  end;

end;
||<

みたいな。

ほいで、LTypeに対してメソッドやらフィールドやらプロパティやらちょーだいーゆーて。

>|pascal|
var
  LMethod: TRttiMethod;
  LField: TRttiField;
  LProperty: TRttiProperty;

begin
  LMethod := LType.GetMethod('メソッド名');
  LField := LType.GetField('フィールド名');
  LProperty := LType.GetProperty('プロパティ名');

end;
||<

ほいで、あとは、
LMethodをInvokeして実行したり、
LFieldをGetValueしたり、
LPropertyにSetValueしたり。

いろいろできちゃう下地ができましたよーってな感じで、以上。
