---
Title: 複数アカウントで同時利用可能！ハイスペックなWindows7をクラウドクライアントPCにする方法
Category:
- Windows
Date: 2011-08-16T00:00:00+09:00
URL: https://yoshiyoshifujii.hatenablog.com/entry/20110816/p1
EditURL: https://blog.hatena.ne.jp/yoshiyoshifujii/yoshiyoshifujii.hatenablog.com/atom/entry/11696248318757242167
---

会社でハイスペックなPCを購入したが、なんだか持て余しているので、兼ねてから密かに計画していたクラウドクライアント(私の造語?)の環境を作ってみた。

そのやり方をメモする。

クラウドクライアントというのは、Windows7に、複数アカウントを作って、皆でリモートアクセスして使おうぜ、というもの。

まずは、ハイスペックなところを説明。

- Intel Core i7 Quad
- メモリ12GB
- HDD 1TB
- Windows 7 Ultimate 64bit

まあ、持て余すよね。この環境。ハイスペックですよね。

で、このハイスペックPCを皆で共有しようぜ！というのが今回の目的。

**クラウドサーバーの構築方法(Windows7の設定)
まずは、クラウドサーバー側となる、Windows7 Ultimate 64bit側での設定方法をまとめる。

クラウドとして使う方法として、Windows系ならやっぱり [[リモートデスクトップ]] だろう。ここで問題は、 [[リモートデスクトップ]] はローカルでしか使えない。ローカルでしか使えないクラウドなんてしょぼい上にださい。(意味不明)

なるべくセーフティでストレスの無い環境をグローバルに作りたいんだー。

で、ちょっと調べたら、Remote Desktop Over SSHなる方法が見つかった。

じゃ、これでやんべ。あれでもWindowsでSSHサーバー立てるのってcygwinとかいるんじゃなかったっけ。やべーめんどくせー。いいや。ハイスペックだし、VMWare Serverでも入れてUbuntu入れてOpenSSHでやんべ。固定IPとか高くつくし、ダイナミックDNSでやんべ。そういやWindows7のサーバー版じゃねーからリモートでアクセスできんの一人やん。なんか方法ねーかなー。

ということで、

- [http://www.vmware.com/jp/products/datacenter-virtualization/server/overview:title=VMWare Server]
- [http://www.ubuntulinux.jp/News/ubuntu1004:title=Ubuntu 10.04 LTS]
- [http://debianj.com/ubuntu/install/openssh.html:title=OpenSSH]
- [http://ieserver.net/:title]
- [http://gigazine.net/news/20091205_universal_termsrv_dll_patch/:title]

これらの情報を元にサーバー環境を構築した。

最初に、VMWare Serverをインストール。

次に、VMWare Server上でUbuntu 10.04 LTSをインストール。

VMWare Server上のUbuntu 10.04 LTSにOpenSSHをインストール。

OpenSSHは、とりあえず、ほとんどデフォルトだが、最終的には、キー認証のみ許可する予定。(他に何かしたかもしらんがまた別で書く)

無料のダイナミックDNSサービスは、定期的に登録しているグローバルIPアドレスを更新してやる必要がある。

そこで、[http://ieserver.net/tools.html:title=IPアドレス更新サンプルスクリプト] を参考に、Perl、wget、cronで10分ごとに実行するようにした。

http://ieserver.net/ddns-update.txt をvimで編集して、

>||
/usr/local/ddns/ddns-update.pl
||<

に保存。

>||
$> sudo chmod 755 /usr/local/ddns/ddns-update.pl
$> sudo chown root:root /usr/local/ddns/ddns-update.pl
||<

とかして、ルートにして実行権限にした。

その後、

>||
$> crontab -e
||<

とかして、

>||
5,15,25,35,45,55 * * * * /usr/local/ddns/ddns-update.pl
||<

ってやつを入力して保存した。

ここまでやると、Windows7のVMWare Server上でUbuntu 10.04 LTSを動作させ、Ubuntu 10.04 LTS上で、OpenSSHサーバーと、cronでダイナミックDNSを更新する環境が整った。

この後、 [http://gigazine.net/news/20091205_universal_termsrv_dll_patch/:title] を参考に、リモートデスクトップのセッション数制限を解除した。

そうそう、ここまで書いて思い出したが、この後、ルーターの22番ポートに穴を開ける必要があったんだった。

まあそれはルーター毎に設定方法が違うし、何とも言えないが、まあルーターのWAN側に22番ポートアクセスがあったときに、ローカルのどのPCにアクセス許可すんの?的な設定をした。

また、次の記事で、今度はこのサーバーにアクセスする方法を書くと思う。
